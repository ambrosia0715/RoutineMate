# ============================================
# ğŸ§­ RoutineMate Codex ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ (CLI ë¶ˆí•„ìš”)
# Flutter + Firebase + AdMob + í™•ì¥ ê¸°ëŠ¥ + Android ë°°í¬ ìë™í™”
# íŒŒì¼ëª…: routine_mate_final_build.yaml
# ============================================

pipeline:
  name: "RoutineMate Codex ë¹Œë“œ & ë°°í¬ ìë™í™”"
  steps:

    # ----------------------------------------
    # 1ï¸âƒ£ í”„ë¡œì íŠ¸ ìƒì„± ë° ê¸°ë³¸ íŒ¨í‚¤ì§€ ì¶”ê°€
    # ----------------------------------------
    - name: "Flutter í”„ë¡œì íŠ¸ ìƒì„±"
      run: |
        create flutter-app "routine_mate"
        add packages "firebase_core firebase_auth cloud_firestore flutter_tts flutter_local_notifications google_mobile_ads provider intl"
        write description "RoutineMateëŠ” ë£¨í‹´ì„ ë“±ë¡í•˜ë©´ ì§€ì •ëœ ì‹œê°„ë§ˆë‹¤ TTSì™€ ì•Œë¦¼ìœ¼ë¡œ ì‹œì‘, ì¤‘ê°„, ì¢…ë£Œ ìƒíƒœë¥¼ ì•Œë ¤ ì£¼ê³  ë£¨í‹´ ìˆ˜í–‰ë¥ ì„ ë¦¬í¬íŠ¸ë¡œ ë³´ì—¬ ì£¼ëŠ” ë£¨í‹´ ê´€ë¦¬ ì•±ì…ë‹ˆë‹¤. ê° ë£¨í‹´ì€ 10ë¶„ ë‹¨ìœ„ë¡œ ì„¤ì •í•˜ë©° ì‹œê°„ì´ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ê²€ì¦í•©ë‹ˆë‹¤. í•˜ë‹¨ì—ëŠ” Google AdMob ê´‘ê³ ê°€ í‘œì‹œë©ë‹ˆë‹¤."

    # ----------------------------------------
    # 2ï¸âƒ£ Firebase ì„¤ì • ë³µì‚¬ ë° ì´ˆê¸°í™”
    # ----------------------------------------
    - name: "Firebase ì„¤ì • íŒŒì¼ ë³µì‚¬"
      run: |
        mkdir -p android/app
        cp ./google-services.json ./android/app/google-services.json
        write guide "Firebase ì„¤ì • ì ˆì°¨:\n1. Firebase ì½˜ì†”ì—ì„œ RoutineMate í”„ë¡œì íŠ¸ ìƒì„±\n2. Android ì•± ë“±ë¡ (íŒ¨í‚¤ì§€ëª…: com.routinemate.app)\n3. google-services.jsonì„ ìµœìƒìœ„ í´ë”ì— ë‘ê³  android/appìœ¼ë¡œ ë³µì‚¬\n4. flutterfire configure ëª…ë ¹ìœ¼ë¡œ firebase_options.dart ìƒì„±"

    - name: "Firebase ì´ˆê¸°í™” ì½”ë“œ ì‘ì„±"
      run: |
        write code "lib/main.dart" \
          --language "dart" \
          --content "
        import 'package:flutter/material.dart';
        import 'package:firebase_core/firebase_core.dart';
        import 'firebase_options.dart';
        import 'package:google_mobile_ads/google_mobile_ads.dart';

        void main() async {
          WidgetsFlutterBinding.ensureInitialized();
          await Firebase.initializeApp(
            options: DefaultFirebaseOptions.currentPlatform,
          );
          await MobileAds.instance.initialize();
          runApp(const RoutineMateApp());
        }

        class RoutineMateApp extends StatelessWidget {
          const RoutineMateApp({super.key});

          @override
          Widget build(BuildContext context) {
            return MaterialApp(
              title: 'RoutineMate',
              debugShowCheckedModeBanner: false,
              home: Scaffold(
                body: Center(child: Text('RoutineMate ì´ˆê¸° ì„¤ì • ì™„ë£Œ ğŸš€')),
              ),
            );
          }
        }
        "

    # ----------------------------------------
    # 3ï¸âƒ£ ë¡œê·¸ì¸ í™”ë©´ êµ¬ì„±
    # ----------------------------------------
    - name: "ë¡œê·¸ì¸ í™”ë©´ ìƒì„±"
      run: |
        generate screen "login_screen" \
          --fields "ì´ë©”ì¼, ë¹„ë°€ë²ˆí˜¸, ë¡œê·¸ì¸ ë²„íŠ¼, íšŒì›ê°€ì… ë²„íŠ¼, ë¹„íšŒì› ì²´í—˜ ë²„íŠ¼" \
          --logic "Firebase Auth ë¡œê·¸ì¸, íšŒì›ê°€ì…, ê²ŒìŠ¤íŠ¸ ëª¨ë“œ" \
          --style "ì‹¬í”Œí•˜ê³  ì§ê´€ì ì¸ UI, ì•± ë¡œê³  í¬í•¨"

    # ----------------------------------------
    # 4ï¸âƒ£ í™ˆ í™”ë©´ (24ì‹œê°„ ë£¨í‹´ ê·¸ë˜í”„ + ê´‘ê³ )
    # ----------------------------------------
    - name: "í™ˆ í™”ë©´ ìƒì„±"
      run: |
        generate screen "home_screen" \
          --elements "24ì‹œê°„ ì›í˜• ê·¸ë˜í”„, ë£¨í‹´ ë¦¬ìŠ¤íŠ¸, ë‚ ì§œ ì„ íƒ ìº˜ë¦°ë”, í•˜ë‹¨ ë°°ë„ˆ ê´‘ê³ " \
          --library "fl_chart" \
          --style "ë¯¸ë‹ˆë©€, ì‹œê°„ëŒ€ë³„ ë£¨í‹´ ì‹œê°í™”"

    # ----------------------------------------
    # 5ï¸âƒ£ ë£¨í‹´ ë“±ë¡ ë° ê´€ë¦¬
    # ----------------------------------------
    - name: "ë£¨í‹´ ë“±ë¡ ê¸°ëŠ¥ ì¶”ê°€"
      run: |
        generate screen "add_routine_screen" \
          --fields "ë£¨í‹´ëª…, ì‹œì‘ ì‹œê°„, ì¢…ë£Œ ì‹œê°„, ë°˜ë³µ ìš”ì¼, TTS ë¬¸êµ¬, ì•Œë¦¼ ë¬¸êµ¬" \
          --validation "ì‹œê°„ 10ë¶„ ë‹¨ìœ„, ê²¹ì¹˜ëŠ” ì‹œê°„ ìë™ ê²€ì‚¬" \
          --logic "Firestore ì¤‘ë³µ ê²€ì¦ ë° ì €ì¥"

    # ----------------------------------------
    # 6ï¸âƒ£ TTS ë° ì•Œë¦¼ ëª¨ë“ˆ
    # ----------------------------------------
    - name: "TTSì™€ ì•Œë¦¼ ëª¨ë“ˆ ìƒì„±"
      run: |
        generate module "tts_module" \
          --description "ë£¨í‹´ ì‹œì‘/ì¤‘ê°„/ì¢…ë£Œ ì‹œ flutter_ttsë¡œ ìŒì„± ì•ˆë‚´"
        generate module "notification_module" \
          --description "ë£¨í‹´ ì‹œì‘ ì‹œê°„ì— flutter_local_notificationsë¡œ ì•Œë¦¼ ì˜ˆì•½"

    # ----------------------------------------
    # 7ï¸âƒ£ ë¦¬í¬íŠ¸ í™”ë©´ (ê¸°ë³¸)
    # ----------------------------------------
    - name: "ë¦¬í¬íŠ¸ í™”ë©´ êµ¬ì„±"
      run: |
        generate screen "report_screen" \
          --charts "ë£¨í‹´ ìˆ˜í–‰ë¥  ë§‰ëŒ€ ì°¨íŠ¸, ì£¼ë³„ ì‹œê°„ ë„ë„› ì°¨íŠ¸" \
          --stats "ì£¼ê°„ ì„±ê³µë¥ , í‰ê·  ìˆ˜í–‰ ì‹œê°„"

    # ----------------------------------------
    # 8ï¸âƒ£ AdMob ê´‘ê³  ì„¤ì •
    # ----------------------------------------
    - name: "AdMob ì„¤ì •"
      run: |
        write guide "AdMob ì„¤ì •:\n- App ID: ca-app-pub-1444459980078427~7187235817\n- AndroidManifest.xml <application> ë‚´ë¶€ì— ë©”íƒ€ë°ì´í„° ì¶”ê°€:\n  <meta-data\n      android:name='com.google.android.gms.ads.APPLICATION_ID'\n      android:value='ca-app-pub-1444459980078427~7187235817' />"
        generate component "ad_banner_widget" \
          --description "Google AdMob í•˜ë‹¨ ë°°ë„ˆ (RoutineMate App ID ì‚¬ìš©)" \
          --library "google_mobile_ads" \
          --props "adUnitId='ca-app-pub-1444459980078427~7187235817', position=bottom"
        integrate component "ad_banner_widget" into "home_screen, report_screen, add_routine_screen"

    # ----------------------------------------
    # 9ï¸âƒ£ í™•ì¥ ê¸°ëŠ¥ í†µí•©
    # ----------------------------------------
    - name: "RoutineMate í™•ì¥ ê¸°ëŠ¥ ì¶”ê°€"
      run: |
        generate module "routine_repeat_options" \
          --description "ë£¨í‹´ ë°˜ë³µ ì˜µì…˜: ë§¤ì¼, ì£¼ì¤‘, ì£¼ë§, ì‚¬ìš©ì ì§€ì • ìš”ì¼"
        generate function "pause_routine" \
          --logic "ë£¨í‹´ ì¼ì‹œ ë¹„í™œì„±í™” ë° ì•Œë¦¼ ì¤‘ë‹¨"
        generate function "duplicate_routine" \
          --logic "ê¸°ì¡´ ë£¨í‹´ì„ ë³µì œí•´ ìƒˆ ë£¨í‹´ ìƒì„±"
        generate screen "routine_feedback_dialog" \
          --elements "ê°ì • ì•„ì´ì½˜(ğŸ˜€~ğŸ˜), ë§Œì¡±ë„(1~5), ë©”ëª¨ ì…ë ¥"
        extend screen "report_screen" \
          --add "ê°ì • ì¶”ì„¸ ë¼ì¸ ì°¨íŠ¸, ë©”ëª¨ í•˜ì´ë¼ì´íŠ¸"
        generate screen "notification_settings" \
          --fields "ì•Œë¦¼ìŒ, ì§„ë™, ìŒì„± ì†ë„, ëª©ì†Œë¦¬ ì„ íƒ"
        generate module "routine_widget" \
          --description "í™ˆ í™”ë©´ ìœ„ì ¯ìœ¼ë¡œ ì˜¤ëŠ˜ ë£¨í‹´ ìƒíƒœ í‘œì‹œ"
        generate module "routine_backup" \
          --description "ë£¨í‹´ ë¡œê·¸/ë°±ì—… ìë™ ì €ì¥ ë° ë³µì›"
        generate component "rewarded_ad_widget" \
          --description "ë£¨í‹´ í™•ì¥/í”„ë¦¬ë¯¸ì—„ ì²´í—˜ ë³´ìƒí˜• ê´‘ê³ " \
          --library "google_mobile_ads" \
          --props "adUnitId='ca-app-pub-1444459980078427~7187235817'"
        generate module "firebase_messaging" \
          --description "3ì¼ ë¯¸ì ‘ì† ì‚¬ìš©ìì—ê²Œ ë¦¬ë§ˆì¸ë” í‘¸ì‹œ ì „ì†¡"

    # ----------------------------------------
    # ğŸ”Ÿ í”„ë¦¬ë¯¸ì—„ êµ¬ë… ì „ëµ
    # ----------------------------------------
    - name: "í”„ë¦¬ë¯¸ì—„ êµ¬ë… ì„¤ì •"
      run: |
        generate screen "premium_info_screen" \
          --elements "í”„ë¦¬ë¯¸ì—„ í˜œíƒ ì„¤ëª…, ê²°ì œ ë²„íŠ¼, êµ¬ë… ìƒíƒœ í‘œì‹œ" \
          --logic "Google Play Billing ì—°ë™"
        update section "í”„ë¦¬ë¯¸ì—„ ì •ì±…" \
          --content "í”„ë¦¬ë¯¸ì—„: ë¬´ì œí•œ ë£¨í‹´, ê´‘ê³  ì œê±°, ê³ ê¸‰ TTS, ê°ì • ë¦¬í¬íŠ¸ í¬í•¨ (ì›” 4,900ì› / ì—° 39,000ì›)"

    # ----------------------------------------
    # 11ï¸âƒ£ Android ë¹Œë“œ ë° ë°°í¬
    # ----------------------------------------
    - name: "Android ë¹Œë“œ ì¤€ë¹„ ë° ë°°í¬"
      run: |
        configure build "Android release ë¹Œë“œ ì„¤ì •"
        prepare publish \
          --google-play "RoutineMate - ë£¨í‹´ ê´€ë¦¬ ìë™ ì•Œë¦¼ & í”„ë¦¬ë¯¸ì—„ êµ¬ë… í¬í•¨" \
          --version "1.0.0" \
          --release-notes "ì •ì‹ ì¶œì‹œ: ë£¨í‹´ ê´€ë¦¬, ì‹¤í–‰ ì•Œë¦¼, ë¦¬í¬íŠ¸, ê´‘ê³  ë° í”„ë¦¬ë¯¸ì—„ ê¸°ëŠ¥ í¬í•¨"

    # ----------------------------------------
    # âœ… ìµœì¢… ì‹¤í–‰
    # ----------------------------------------
    - name: "RoutineMate íŒŒì´í”„ë¼ì¸ ì‹¤í–‰"
      run: |
        run pipeline "RoutineMate Final Build" \
          --steps "Firebase ë“±ë¡, í™ˆ/ë¡œê·¸ì¸, ì•Œë¦¼/TTS, ë¦¬í¬íŠ¸/í™•ì¥ ê¸°ëŠ¥, ê´‘ê³ , í”„ë¦¬ë¯¸ì—„, ë¹Œë“œ/ë°°í¬"
